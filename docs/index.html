<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>'Open Data Kit' ('ODK') R API • odkr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="'Open Data Kit' ('ODK') R API">
<meta property="og:description" content="Utility functions for working with datasets gathered using
    'Open Data Kit' ('ODK') &lt;https://opendatakit.org/&gt;. These include an API to 
    interface with 'ODK Briefcase', a 'Java' application for fetching and pushing 
    'ODK' forms and their contents, that allows pulling of data from either a remote 
    'ODK Aggregate Server' or a local 'ODK' folder, a rename function to give more 
    human readable variable names for 'ODK' datasets, a merge function to create 
    a single dataframe from a nested 'ODK' dataset and an expand function to 
    disaggregate multiple choice answers that have been collapsed into single code 
    by 'ODK'.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-102485058-5"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-102485058-5');
</script>
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">odkr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/validmeasures/odkr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="contents col-md-9">
<div id="odkr-open-data-kit-odk-r-api" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#odkr-open-data-kit-odk-r-api" class="anchor"></a>odkr: Open Data Kit (ODK) R API <img src="reference/figures/odkr.png" width="200" align="right">
</h1></div>

<p><strong>Open Data Kit (ODK)</strong> is a free and open-source set of tools which help organizations author, field, and manage mobile data collection solutions. ODK provides an out-of-the-box solution for users to:</p>
<ul>
<li>Build a data collection form or survey;</li>
<li>Collect the data on a mobile device and send it to a server; and</li>
<li>Aggregate the collected data on a server and extract it in useful formats.</li>
</ul>
<p><code>odkr</code> is a set of interface and utility tools for a <strong>useR</strong> working with ODK. The package currently has two classes of functions: 1) <em>data processing</em> tools; and, 2) <em>ODK-R interface</em> functions.</p>
<p>For <em>data processing</em>, there are currently three functions included which can be used to perform typical data processing tasks associated with working with ODK-collected datasets such as renaming variables in a dataset, expansion of responses to questions that allow more than one answer and merging of nested datasets.</p>
<p>For <em>ODK-R interface</em>, included are a set of functions that work via a command line interface with the Java application <strong>ODK Briefcase</strong> for fetching and pushing Open Data Kit (ODK) forms and their contents. It can be used to gather and aggregate data from the mobile client <strong>ODK Collect</strong> when there is no internet connectivity, when there is no <strong>ODK Aggregate Server</strong> set-up or when an <strong>ODK Aggregate Server</strong> is not preferred. Current production version of <strong>ODK Briefcase</strong> is v1.8.0 and an executable <code>.jar</code> file can be downloaded from the Open Data Kit <a href="https://opendatakit.org/use/briefcase/">website</a>.</p>
<p>As of <strong>ODK Briefcase</strong> version 1.4.4, a scriptable command line interface (CLI) to the Java application has been available. This package provides an R interface to <strong>ODK Briefcase</strong> via the available CLI to pull forms from a remote <strong>ODK Aggregate Server</strong> or from a local ODK folder <code>/odk</code> collected from mobile clients. This package has a function that downloads the lastest version of <strong>ODK Briefcase</strong> (currently v1.8.0) and additional functions that use the CLI of <strong>ODK Briefcase</strong> to perform data extraction and data export. This package requires Java 8 installed. Jave 8 can be downloaded from <a href="https://java.com/en/download/">here</a>.</p>
<div id="requirements" class="section level2">
<h2 class="hasAnchor">
<a href="#requirements" class="anchor"></a>Requirements</h2>
<p>The ODK-R interface component of this package requires <strong>Java 8</strong> to be installed in your computer. There are known <a href="https://forum.opendatakit.org/t/odk-briefcase-not-running-with-jdk-9/10201">issues</a> when using ODK Briefcase with <strong>Java 9</strong>. If you have <strong>Java 9</strong> installed, uninstall (on <a href="https://www.java.com/en/download/help/uninstall_java.xml">Windows</a>; on <a href="https://www.java.com/en/download/help/mac_uninstall_java.xml">macOS</a>) and then <a href="https://java.com/en/download/">install</a> <strong>Java 8</strong>. If issues persist even with <strong>Java 8</strong>, you may need to reconfigure <strong>Java</strong>. On the terminal, execute the following command:</p>
<pre class="shell"><code>R CMD javareconf</code></pre>
<p>If reconfiguring <strong>Java</strong> still doesn’t solve the issue, you may need to specify <code>JAVA_HOME</code> by executing the following command in terminal:</p>
<pre class="shell"><code>sudo R CMD javareconf JAVA_HOME=/usr/java/default</code></pre>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Install <code>odkr</code> from CRAN:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"odkr"</span>)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(odkr)</a></code></pre></div>
<p>Install development version of <code>odkr</code> by installing devtools and then installing <code>odkr</code> package via git</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># install.packages("devtools")</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"validmeasures/odkr"</span>)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(odkr)</a></code></pre></div>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<div id="data-processing-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#data-processing-functions" class="anchor"></a>Data processing functions</h3>
<p><strong>1. Rename variables of an ODK-collected dataset</strong></p>
<p>Depending on how you have designed and structured your ODK form, the standard naming of variables of the output dataset isn’t always desirable for eventual data processing and analysis. For example, for ODK forms that groups questions into modules or sets, ODK would append the grouping name as a prefix to the actual name assigned to a variable usually separated by a <code>/</code> or a <code>.</code>.</p>
<p>The <code>renameODK()</code> function extracts the actual variable name assigned when designing the form by removing the prefix grouping labels. This can be done by simply applying the <code>renameODK()</code> to the data.frame as follows:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">renameODK</span>(sampleData1)</a></code></pre></div>
<p><strong>2. Expand multiple answer responses</strong></p>
<p>For survey questions that allow for multiple answers to be provided, the <code>expandMultChoice()</code> function recodes this into multiple columns with <code>0/1</code> coding the number of which is equivalent to the number choices that were selected by respondents. This function can be called as follows:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># Expand the choices in variable ws7</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw">expandMultChoice</span>(<span class="dt">answers =</span> <span class="kw">renameODK</span>(sampleData2)<span class="op">$</span>ws7)</a></code></pre></div>
<p><strong>3. Merge nested datasets</strong> For ODK forms with a <code>repeat</code> argument, the resulting dataset splits the data into each of the repeats. Often, these multiple datasets need to be merged to a parent dataset (usually data containing common identifiers such as cluster, household). The <code>mergeNestedODK()</code> function merges together these datasets using the ODK-defined <code>KEY</code> and <code>PARENT-KEY</code> variables. The function can be called as follows:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">mergeNestedODK</span>(<span class="dt">parent =</span> <span class="kw">renameODK</span>(sampleData1),</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">               <span class="dt">child =</span> <span class="kw">renameODK</span>(sampleData2))</a></code></pre></div>
</div>
<div id="odk-r-interface-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#odk-r-interface-functions" class="anchor"></a>ODK-R interface functions</h3>
<p>Following are the ODK interface functions in the <code>odkr</code> package. However, before these functions can be utilised, a local copy of <strong>ODK Briefcase</strong> needs to be downloaded and it would be through this local copy of <strong>ODK Briefcase</strong> that the other functions will integrate wit ODK databases.</p>
<p>To download the latest version of <strong>ODK Briefcase</strong>, the <code>get_briefcase()</code> function can be utilised as follows:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">get_briefcase</span>(<span class="dt">destination =</span> <span class="st">"~/Desktop"</span>)</a></code></pre></div>
<p>will download the latest version of <strong>ODK Briefcase</strong> in your <code>Desktop</code> and rename it as <code>odkBriefcase_latest</code>. Specifying the destination directory for <strong>ODK Briefcase</strong> is required.</p>
<p>If it is preferred to save the <strong>ODK Briefcase</strong> with a different filename, the following command can be issued in R:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">get_briefcase</span>(<span class="dt">destination =</span> <span class="st">"~/Desktop"</span>, <span class="dt">briefcase =</span> <span class="st">"odkTool"</span>)</a></code></pre></div>
<p>This will save a local copy of <strong>ODK Briefcase</strong> in the <code>Desktop</code> and name it as <code>odkTool.jar</code>.</p>
<p>Downloading <strong>ODK Briefcase</strong> can be done only once unless you want to update to the latest version of <strong>ODK Briefcase</strong> from a previously downloaded older version.</p>
<p>Once you have downloaded <strong>ODK Briefcase</strong>, the following functions can be utilised to integrate with ODK databases.</p>
<p><strong>1. Pull forms from a remote ODK Aggregate Server</strong> If you have an <strong>ODK Aggregate Server</strong> already setup receiving form submissions from your survey, you can use <code>odkr</code> to pull these forms (not the data) into a local directory.</p>
<p>For example, you want to pull ODK form with form id <code>stakeholders</code> from your remote <strong>ODK Aggregate Server</strong> (i.e., ONA) <code>https://ona.io/validtrial/</code> to a local directory <code>~/Desktop</code> using your <strong>ODK Aggregate Server</strong> account with <strong><em>username</em></strong> <code>validtrial</code> and <strong><em>password</em></strong> <code>zEF-STN-5ze-qom</code>. The <code>pull_remote</code> function from <code>odkr</code> can be used as follows:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">pull_remote</span>(<span class="dt">target =</span> <span class="st">"~Desktop"</span>,</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">            <span class="dt">id =</span> <span class="st">"stakeholders"</span>,</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">            <span class="dt">to =</span> <span class="st">"~/Desktop"</span>,</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">            <span class="dt">from =</span> <span class="st">"https://ona.io/validtrial/"</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5">            <span class="dt">username =</span> <span class="st">"validtrial"</span>,</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">            <span class="dt">password =</span> <span class="st">"zEF-STN-5ze-qom"</span>)</a></code></pre></div>
<p>In this example, you will note that we are using a previously downloaded <strong>ODK Briefcase</strong> saved in the <code>Desktop</code>. The <code>target</code> specification can be changed to the directory where you have previously saved <strong>ODK Briefcase</strong>.</p>
<p>After the operation has been completed, you would now be able to see a folder named <strong>ODK Briefcase Storage</strong> on your <code>Desktop</code> containing the forms and instances from the stakholders form on the <strong>ODK Aggregate Server</strong>.</p>
<p><strong>2. Pull forms from a local <code>/odk</code> folder extracted from ODK Collect</strong> If you do not have an <strong>ODK Aggregate Server</strong> setup and plan to use <strong>ODK Briefcase</strong> as your form aggregator, you will have to extract/copy the <code>/odk</code> folder in your mobile client to a location in your computer (e.g., <code>~/Desktop</code>) to which you can apply the <code>pull_local</code> function to pull out the forms and instances to a local directory (e.g., <code>~/Desktop</code>) as follows:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">pull_local</span>(<span class="dt">target =</span> <span class="st">"~/Desktop"</span>,</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">           <span class="dt">id =</span> <span class="st">"stakeholders"</span>,</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">           <span class="dt">to =</span> <span class="st">"~/Desktop"</span>,</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">           <span class="dt">from =</span> <span class="st">"~/Desktop"</span>)</a></code></pre></div>
<p>In this example, you will note that we are using a previously downloaded <strong>ODK Briefcase</strong> saved in the <code>Desktop</code>. The <code>target</code> specification can be changed to the directory where you have previously saved <strong>ODK Briefcase</strong>.</p>
<p>After the operation has been completed, you would now be able to see a folder named <strong>ODK Briefcase Storage</strong> on your desktop containing the forms and instances from the stakholders form on the <strong>ODK Aggregate Server</strong>.</p>
<p><strong>3. Export data from an ODK Briefcase Storage into a CSV file</strong> If you have pulled your forms from either a remote <strong>ODK Aggregate Server</strong> or a local <code>/odk</code> folder and now have an <strong>ODK Briefcase Storage</strong> in one of your local directories, you will probably want to extract the data found in these forms for use in other purposes e.g., data analysis.</p>
<p>The <code>export_data</code> function allows you to extract data from a local <strong>ODK Briefcase Storage</strong> (e.g., found in your <code>~/Desktop</code>) containing a form <code>stakeholders</code> and save it in a local directory (e.g., <code>~/Desktop</code>) as a <code>.csv</code> file named <code>test.csv</code> as follows:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">export_data</span>(<span class="dt">target =</span> <span class="st">"~/Desktop"</span>,</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">            <span class="dt">id =</span> <span class="st">"stakeholders"</span>,</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">            <span class="dt">from =</span> <span class="st">"~/Desktop"</span>,</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">            <span class="dt">to =</span> <span class="st">"~/Desktop"</span>,</a>
<a class="sourceLine" id="cb12-5" data-line-number="5">            <span class="dt">filename =</span> <span class="st">"test.csv"</span>)</a></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=odkr">https://​cloud.r-project.org/​package=odkr</a>
</li>
<li>Browse source code at <br><a href="https://github.com/validmeasures/odkr">https://​github.com/​validmeasures/​odkr</a>
</li>
<li>Report a bug at <br><a href="https://github.com/validmeasures/odkr/issues">https://​github.com/​validmeasures/​odkr/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Ernest Guevarra <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0002-4887-4415" target="orcid.widget"><img src="https://members.orcid.org/sites/default/files/vector_iD_icon.svg" class="orcid" alt="ORCID" height="16"></a> </li>
<li>Laura Bramley <br><small class="roles"> Author, copyright holder </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="http://www.repostatus.org/#active"><img src="http://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active – The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="https://cran.r-project.org/package=odkr"><img src="https://img.shields.io/cran/v/odkr.svg" alt="CRAN"></a></li>
<li><a href="https://CRAN.R-project.org/package=odkr"><img src="https://img.shields.io/cran/l/odkr.svg" alt="CRAN"></a></li>
<li><a href="https://CRAN.R-project.org/package=odkr"><img src="http://cranlogs.r-pkg.org/badges/odkr" alt="CRAN"></a></li>
<li><a href="https://CRAN.R-project.org/package=odkr"><img src="http://cranlogs.r-pkg.org/badges/grand-total/odkr" alt="CRAN"></a></li>
<li><a href="https://travis-ci.org/validmeasures/odkr"><img src="https://img.shields.io/travis/validmeasures/odkr.svg?branch=master" alt="Travis"></a></li>
<li><a href="https://ci.appveyor.com/project/validmeasures/odkr"><img src="https://ci.appveyor.com/api/projects/status/github/validmeasures/odkr?branch=master&amp;svg=true" alt="AppVeyor Build Status"></a></li>
<li><a href="https://codecov.io/gh/validmeasures/odkr"><img src="https://codecov.io/gh/validmeasures/odkr/branch/master/graph/badge.svg" alt="codecov"></a></li>
<li><a href="https://doi.org/10.5281/zenodo.1170514"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.1170514.svg" alt="DOI"></a></li>
</ul>
</div>
</div>
</div>

      <footer><div class="copyright">
  <p>Developed by Ernest Guevarra, Laura Bramley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
